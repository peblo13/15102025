<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>üîç Baza CV - eCVjob.pl</title>
    
    <!-- SEO & Performance -->
    <meta name="description" content="PrzeglƒÖdaj profesjonalne CV kandydat√≥w w bazie eCVjob.pl. Znajd≈∫ idealnego pracownika dziƒôki zaawansowanemu wyszukiwaniu.">
    <meta name="keywords" content="baza CV, kandydaci, rekrutacja, wyszukiwanie pracownik√≥w, zatrudnienie">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: url('images/tlo.jpg') no-repeat center center fixed;
            background-size: cover;
            color: #fff;
            min-height: 100vh;
            line-height: 1.6;
        }
        /* Fixed, fitted background on small screens */
        @media (max-width: 768px) {
            body { background: transparent !important; }
            body::before {
                content: '';
                position: fixed;
                top: 0; left: 0; right: 0; bottom: 0;
                background: url('images/tlo.jpg') no-repeat center center;
                background-size: cover;
                z-index: -1;
                pointer-events: none;
                transform: translateZ(0);
            }
        }
        
        /* Header & Navigation */
        .header {
            background: rgba(0, 0, 0, 0.9);
            padding: 1rem 0;
            box-shadow: 0 2px 20px rgba(0, 255, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #00ff00;
            text-decoration: none;
            text-shadow: 0 0 10px #00ff00;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        .nav-menu a {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .nav-menu a:hover {
            color: #00ff00;
        }
        
        .back-btn {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000;
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 255, 0, 0.3);
        }
        
        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 255, 0, 0.4);
        }
        /* Always-visible fixed back button (do not clash with .back-btn above) */
        .fixed-back-btn {
            position: fixed;
            top: calc(14px + env(safe-area-inset-top));
            left: 14px;
            z-index: 9999;
            background: rgba(0,0,0,0.8);
            color:#00ff00;
            border:2px solid #00ff00;
            border-radius: 12px;
            padding: 10px 14px;
            font-weight: 800;
            letter-spacing: .5px;
            box-shadow: 0 6px 24px rgba(0,255,0,.25);
            cursor: pointer;
        }
        .fixed-back-btn:active { transform: scale(.98) }
        @media (max-width: 768px) { .fixed-back-btn { font-size: 14px } }
        
        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Hero Section */
        .hero {
            text-align: center;
            padding: 3rem 0;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .hero h1 {
            font-size: 3.5rem;
            color: #00ff00;
            margin-bottom: 1rem;
            font-weight: bold;
            text-shadow: 0 0 20px #00ff00;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 20px #00ff00; }
            to { text-shadow: 0 0 30px #00ff00, 0 0 40px #00ff00; }
        }
        
        .hero .subtitle {
            font-size: 1.3rem;
            color: #00fff7;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .counter {
            display: inline-block;
            font-size: 4rem;
            font-weight: 900;
            color: #00fff7;
            text-shadow: 0 0 20px #00fff7;
            animation: pulse 2s ease-in-out infinite;
            margin: 0 1rem;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* Search Section */
        .search-section {
            background: rgba(0, 0, 0, 0.8);
            padding: 2.5rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            border: 2px solid #00ff00;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.3);
        }
        
        .search-title {
            text-align: center;
            color: #00ff00;
            font-size: 2rem;
            margin-bottom: 2rem;
            font-weight: bold;
        }
        
        .search-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            color: #00ff00;
            font-weight: bold;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .form-group input,
        .form-group select {
            padding: 1rem;
            border: 2px solid #333;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            border-color: #00ff00;
            outline: none;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .search-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .search-btn {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            min-width: 150px;
        }
        
        .search-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 255, 0, 0.4);
        }
        
        .clear-btn {
            background: linear-gradient(45deg, #666, #888);
            color: #fff;
        }
        
        .clear-btn:hover {
            box-shadow: 0 6px 20px rgba(102, 102, 102, 0.4);
        }
        
        /* Results Section */
        .results-section {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #333;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .results-title {
            color: #00ff00;
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .results-count {
            color: #00fff7;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .sort-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .sort-select {
            padding: 0.5rem 1rem;
            border: 2px solid #333;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            font-size: 1rem;
        }
        
        /* CV Cards */
        .cv-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .cv-card {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 50, 0, 0.1));
            border: 2px solid #333;
            border-radius: 15px;
            padding: 2rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .cv-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 0, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .cv-card:hover {
            border-color: #00ff00;
            box-shadow: 0 10px 30px rgba(0, 255, 0, 0.3);
            transform: translateY(-5px);
        }
        
        .cv-card:hover::before {
            left: 100%;
        }
        
        .cv-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }
        
        .cv-name {
            font-size: 1.4rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 0.5rem;
        }
        
        .cv-position {
            color: #00ff00;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .cv-location {
            color: #aaa;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .cv-experience {
            background: rgba(0, 255, 247, 0.2);
            color: #00fff7;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .cv-details {
            margin: 1.5rem 0;
        }
        
        .cv-section {
            margin-bottom: 1rem;
        }
        
        .cv-section-title {
            color: #00ff00;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .skill-tag {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.9rem;
            border: 1px solid rgba(0, 255, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .skill-tag:hover {
            background: rgba(0, 255, 0, 0.3);
            transform: scale(1.05);
        }
        
        .cv-summary {
            color: #ccc;
            font-size: 0.95rem;
            line-height: 1.5;
            margin: 1rem 0;
        }
        
        .cv-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 0.7rem 1.2rem;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }
        
        .view-btn {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000;
        }
        
        .contact-btn {
            background: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
        }
        
        .save-btn {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }
        
        .view-btn:hover {
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.4);
        }
        
        .contact-btn:hover {
            background: rgba(0, 255, 0, 0.1);
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.3);
        }
        
        .save-btn:hover {
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }
        
        /* No Results */
        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: #aaa;
        }
        
        .no-results-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        .no-results h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #fff;
        }
        
        .no-results p {
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 2rem;
        }
        
        .spinner {
            border: 4px solid #333;
            border-top: 4px solid #00ff00;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 2rem;
            gap: 1rem;
        }
        
        .pagination button {
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            border: 2px solid #333;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .pagination button:hover:not(:disabled) {
            border-color: #00ff00;
            color: #00ff00;
        }
        
        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .pagination .active {
            background: #00ff00;
            color: #000;
            border-color: #00ff00;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .nav-menu {
                gap: 1rem;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .counter {
                font-size: 3rem;
            }
            
            .search-form {
                grid-template-columns: 1fr;
            }
            
            .cv-grid {
                grid-template-columns: 1fr;
            }
            
            .results-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .cv-actions {
                flex-direction: column;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 1rem;
            }
            
            .hero {
                padding: 2rem 1rem;
            }
            
            .search-section {
                padding: 1.5rem;
            }
            
            .cv-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Permission Validation Script -->
    <script>
        // Check user permissions on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ BAZA CV - Starting initialization...');
            
            // Force setup Enterprise test account first
            console.log('ÔøΩ FORCE SETUP: Setting up Enterprise test account...');
            userData = {
                name: 'test@ecvjob.pl',
                email: 'test@ecvjob.pl',
                plan: 'Enterprise',
                planIcon: 'üèõÔ∏è',
                userId: 'test-enterprise-user'
            };
            
            // Clear any existing data and set fresh Enterprise data
            sessionStorage.clear();
            localStorage.removeItem('currentUser');
            localStorage.removeItem('isLoggedIn');
            
            sessionStorage.setItem('currentUser', JSON.stringify(userData));
            sessionStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('currentUser', JSON.stringify(userData));
            localStorage.setItem('isLoggedIn', 'true');
            
            console.log('‚úÖ FORCE SETUP: Enterprise test account set up:', userData);
            
            // Verify the data was set correctly
            const verifyUser = sessionStorage.getItem('currentUser');
            const verifyLogin = sessionStorage.getItem('isLoggedIn');
            console.log('üîç VERIFY: currentUser in sessionStorage:', verifyUser);
            console.log('üîç VERIFY: isLoggedIn in sessionStorage:', verifyLogin);
            
            if (verifyUser) {
                try {
                    const parsedUser = JSON.parse(verifyUser);
                    console.log('‚úÖ VERIFY: Successfully parsed user data:', parsedUser);
                } catch (e) {
                    console.error('‚ùå VERIFY: Error parsing user data:', e);
                }
            }
            
            // Check if user has access to CV database
            const allowedPlans = ['Premium', 'Business', 'Enterprise'];
            console.log('üîç ACCESS CHECK: User plan:', userData.plan);
            console.log('üîç ACCESS CHECK: Plan type:', typeof userData.plan);
            console.log('üîç ACCESS CHECK: Allowed plans:', allowedPlans);
            console.log('üîç ACCESS CHECK: Plan included?', allowedPlans.includes(userData.plan));
            
            // Since we FORCE set Enterprise above, this should always pass
            if (!userData.plan || !allowedPlans.includes(userData.plan)) {
                console.error('‚ùå ACCESS DENIED: This should NOT happen with forced Enterprise setup!');
                console.error('‚ùå User plan:', userData.plan);
                console.error('‚ùå Type of plan:', typeof userData.plan);
                console.error('‚ùå Plan exists:', !!userData.plan);
                console.error('‚ùå Plan in allowed list:', allowedPlans.includes(userData.plan));
                
                // Try to fix the issue by re-setting Enterprise
                console.log('üîß EMERGENCY FIX: Re-setting Enterprise plan...');
                userData.plan = 'Enterprise';
                userData.planIcon = 'üèõÔ∏è';
                sessionStorage.setItem('currentUser', JSON.stringify(userData));
                localStorage.setItem('currentUser', JSON.stringify(userData));
                
                // Check again
                if (!allowedPlans.includes(userData.plan)) {
                    alert('üö´ Krytyczny b≈ÇƒÖd dostƒôpu! Skontaktuj siƒô z administratorem.');
                    return;
                }
            }
            
            console.log('‚úÖ ACCESS GRANTED: User has valid plan:', userData.plan);
            
            // Show welcome message for Enterprise users
            if (userData.plan === 'Enterprise') {
                console.log('üèõÔ∏è Welcome Enterprise user!');
                setTimeout(() => {
                    if (userData.name && userData.name.includes('test@ecvjob.pl')) {
                        alert('üèõÔ∏è ENTERPRISE PLAN ACTIVE!\n\nKonto: ' + userData.name + '\nPlan: Enterprise\n\nMasz pe≈Çny dostƒôp do bazy CV kandydat√≥w. ‚úÖ');
                    }
                }, 1500);
            }
            
            // Show user info and initialize page
            console.log('üîç INIT: Starting initialization with ultimatePlanSync');
            console.log('üîç INIT: User data:', userData);
            
            // Start DOM monitoring
            monitorUserElements();
            
            // Use the ultimate sync function for initialization too
            ultimatePlanSync();
            
            console.log('‚úÖ User plan displayed via ultimatePlanSync');
            
            // Initialize CV counter animation
            animateCounter();
            
            // Load sample CV data
            loadSampleData();
            
            // Set up periodic plan refresh (every 2 seconds)
            setInterval(() => {
                ultimatePlanSync();
            }, 2000);
            
            // Additional frequent checks for plan synchronization (every 500ms)
            setInterval(() => {
                const userData = sessionStorage.getItem('currentUser');
                if (userData) {
                    const user = JSON.parse(userData);
                    const userPlanEl = document.getElementById('userPlan');
                    const userWelcomeEl = document.getElementById('userWelcome');
                    
                    // Check if elements need updating
                    if (userPlanEl && !userPlanEl.innerHTML.includes(user.plan)) {
                        console.log('üîÑ Plan mismatch detected, forcing ultimatePlanSync');
                        ultimatePlanSync();
                    }
                }
            }, 500);
        });
        
        // Counter animation
        function animateCounter() {
            const counter = document.querySelector('.counter');
            if (!counter) return;
            
            let count = 0;
            const target = 15847;
            const increment = target / 100;
            
            const timer = setInterval(() => {
                count += increment;
                counter.textContent = Math.floor(count).toLocaleString('pl-PL');
                
                if (count >= target) {
                    counter.textContent = target.toLocaleString('pl-PL');
                    clearInterval(timer);
                }
            }, 20);
        }
        
        // ULTIMATE PLAN SYNCHRONIZATION FUNCTION
        function ultimatePlanSync() {
            console.log('üéØ !!!! ULTIMATE SYNC CALLED !!!!');
            console.log('üéØ Call stack:', new Error().stack);
            
            // Get fresh data from sessionStorage
            const userData = sessionStorage.getItem('currentUser');
            console.log('üéØ ULTIMATE SYNC: Raw sessionStorage data:', userData);
            
            if (!userData) {
                console.log('‚ùå ULTIMATE SYNC: No user data found');
                // Clear both elements
                const userInfo = document.getElementById('userWelcome');
                const userPlan = document.getElementById('userPlan');
                if (userInfo) userInfo.innerHTML = '';
                if (userPlan) userPlan.innerHTML = '';
                return;
            }
            
            let user;
            try {
                user = JSON.parse(userData);
            } catch (e) {
                console.error('‚ùå ULTIMATE SYNC: Error parsing user data:', e);
                return;
            }
            
            console.log('üéØ ULTIMATE SYNC: Fresh user data:', user);
            console.log('üéØ ULTIMATE SYNC: Current plan from data:', user.plan);
            
            // Find ALL elements that might show user info
            const userInfo = document.getElementById('userWelcome');
            const userPlan = document.getElementById('userPlan');
            
            console.log('üéØ ULTIMATE SYNC: Found elements:', {
                userInfo: userInfo ? 'FOUND' : 'NOT FOUND',
                userPlan: userPlan ? 'FOUND' : 'NOT FOUND'
            });
            
            // Force clear and rebuild both elements
            if (userInfo) {
                console.log('üéØ ULTIMATE SYNC: Before clearing userWelcome:', userInfo.innerHTML);
                userInfo.innerHTML = ''; // Clear first
                const welcomeText = `<span style="color: #00ff00;">üëã Witaj, ${user.name || user.email}!</span>`;
                userInfo.innerHTML = welcomeText;
                console.log('‚úÖ ULTIMATE SYNC: Set userWelcome to:', welcomeText);
                console.log('üéØ ULTIMATE SYNC: After setting userWelcome:', userInfo.innerHTML);
            } else {
                console.warn('‚ö†Ô∏è ULTIMATE SYNC: userWelcome element not found');
            }
            
            if (userPlan) {
                console.log('üéØ ULTIMATE SYNC: Before clearing userPlan:', userPlan.innerHTML);
                userPlan.innerHTML = ''; // Clear first
                const planIcon = user.plan === 'Enterprise' ? 'üèõÔ∏è' : 
                                user.plan === 'Business' ? 'üè¢' : 
                                user.plan === 'Premium' ? 'üíé' : 'üÜì';
                const planText = `<span style="color: #00fff7;">üìã ${planIcon} ${user.plan || 'FREE'}</span>`;
                userPlan.innerHTML = planText;
                console.log('‚úÖ ULTIMATE SYNC: Set userPlan to:', planText);
                console.log('üéØ ULTIMATE SYNC: After setting userPlan:', userPlan.innerHTML);
            } else {
                console.warn('‚ö†Ô∏è ULTIMATE SYNC: userPlan element not found');
            }
            
            // Force DOM update
            if (userInfo) userInfo.style.display = 'none'; 
            if (userPlan) userPlan.style.display = 'none';
            setTimeout(() => {
                if (userInfo) userInfo.style.display = '';
                if (userPlan) userPlan.style.display = '';
                console.log('üéØ ULTIMATE SYNC: DOM refresh completed');
            }, 10);
            
            console.log('üéâ ULTIMATE SYNC: Synchronization complete for plan:', user.plan);
        }
        
        // Monitor DOM changes in user elements
        function monitorUserElements() {
            const userInfo = document.getElementById('userWelcome');
            const userPlan = document.getElementById('userPlan');
            
            if (userInfo) {
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'childList' || mutation.type === 'characterData') {
                            console.log('üîÑ DOM CHANGE: userWelcome changed to:', userInfo.innerHTML);
                        }
                    });
                });
                observer.observe(userInfo, { childList: true, subtree: true, characterData: true });
            }
            
            if (userPlan) {
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'childList' || mutation.type === 'characterData') {
                            console.log('üîÑ DOM CHANGE: userPlan changed to:', userPlan.innerHTML);
                        }
                    });
                });
                observer.observe(userPlan, { childList: true, subtree: true, characterData: true });
            }
        }
        
        // Function to update user plan display
        function updateUserPlanDisplay() {
            console.log('üîÑ updateUserPlanDisplay() called - delegating to ultimatePlanSync');
            ultimatePlanSync();
        }
        
        // Monitor storage changes to update plan display
        window.addEventListener('storage', function(e) {
            if (e.key === 'currentUser') {
                console.log('üîÑ Storage event detected, using ultimatePlanSync');
                setTimeout(ultimatePlanSync, 10);
                setTimeout(ultimatePlanSync, 100);
                setTimeout(ultimatePlanSync, 300);
                setTimeout(ultimatePlanSync, 1000);
            }
        });
        
        // Override sessionStorage.setItem to catch same-tab changes
        const originalSetItem = sessionStorage.setItem;
        sessionStorage.setItem = function(key, value) {
            originalSetItem.apply(this, arguments);
            if (key === 'currentUser') {
                console.log('üîÑ !!!! sessionStorage.setItem detected !!!!');
                console.log('üîÑ Key:', key);
                console.log('üîÑ New value:', value);
                console.log('üîÑ Call stack:', new Error().stack);
                setTimeout(ultimatePlanSync, 10);
                setTimeout(ultimatePlanSync, 100);
                setTimeout(ultimatePlanSync, 300);
                setTimeout(ultimatePlanSync, 1000);
            }
        };
    </script>
    
    <!-- Header -->
    <!-- Przycisk Wstecz (zawsze widoczny) -->
    <button id="backBtn" class="fixed-back-btn" type="button">‚Üê Wstecz</button>
    <div class="container">
        <section class="hero">
            <h1>üîç Baza CV</h1>
            <div id="userBar" style="display:flex; justify-content:center; gap:12px; margin: 8px 0 6px 0;">
                <span id="userWelcome" style="color:#00ff00; font-weight:bold;"></span>
                <span id="userPlan" style="color:#00fff7; font-weight:bold;"></span>
            </div>
            <p class="subtitle">
                PrzeglƒÖdaj profesjonalne CV kandydat√≥w i znajd≈∫ idealnych pracownik√≥w dla swojej firmy
            </p>
            <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(0, 255, 247, 0.1); border-radius: 10px; border: 1px solid #00fff7;">
                <p style="color: #00fff7; margin-bottom: 0.5rem; font-weight: bold;">
                    üîê Dostƒôp dla plan√≥w Premium, Business i Enterprise
                </p>
                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; font-size: 0.9rem;">
                    <span style="color: #ffd700;">üíé Premium</span>
                    <span style="color: #00ff00;">üè¢ Business</span>
                    <span style="color: #ff6600;">üèõÔ∏è Enterprise</span>
                </div>
                <p style="color: #ffffff; margin-top: 0.5rem; font-size: 0.8rem; text-align: center;">
                    Konto testowe: test@ecvjob.pl ma dostƒôp Enterprise ‚úÖ
                </p>
            </div>
            <div style="margin-top: 2rem;">
                <span style="color: #00fff7; font-size: 1.5rem;">Dostƒôpnych CV:</span>
                <span class="counter">0</span>
            </div>
        </section>
        
        <!-- Search Section -->
        <section class="search-section">
            <h2 class="search-title">üéØ Wyszukiwanie zaawansowane</h2>
            
            <form class="search-form" id="searchForm">
                <div class="form-group">
                    <label for="keyword">üîç S≈Çowa kluczowe</label>
                    <input type="text" id="keyword" placeholder="np. JavaScript, Manager, Marketing">
                </div>
                
                <div class="form-group">
                    <label for="position">üíº Stanowisko</label>
                    <input type="text" id="position" placeholder="np. Developer, Analityk, Kierownik">
                </div>
                
                <div class="form-group">
                    <label for="location">üìç Lokalizacja</label>
                    <select id="location">
                        <option value="">Wszystkie miasta</option>
                        <option value="Warszawa">Warszawa</option>
                        <option value="Krak√≥w">Krak√≥w</option>
                        <option value="Gda≈Ñsk">Gda≈Ñsk</option>
                        <option value="Wroc≈Çaw">Wroc≈Çaw</option>
                        <option value="Pozna≈Ñ">Pozna≈Ñ</option>
                        <option value="≈Å√≥d≈∫">≈Å√≥d≈∫</option>
                        <option value="Katowice">Katowice</option>
                        <option value="Lublin">Lublin</option>
                        <option value="Szczecin">Szczecin</option>
                        <option value="Bydgoszcz">Bydgoszcz</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="experience">‚è±Ô∏è Do≈õwiadczenie</label>
                    <select id="experience">
                        <option value="">Dowolne</option>
                        <option value="0-1">0-1 lat</option>
                        <option value="1-3">1-3 lata</option>
                        <option value="3-5">3-5 lat</option>
                        <option value="5-10">5-10 lat</option>
                        <option value="10+">10+ lat</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="education">üéì Wykszta≈Çcenie</label>
                    <select id="education">
                        <option value="">Dowolne</option>
                        <option value="Podstawowe">Podstawowe</option>
                        <option value="≈örednie">≈örednie</option>
                        <option value="Wy≈ºsze">Wy≈ºsze</option>
                        <option value="Magisterskie">Magisterskie</option>
                        <option value="Doktoranckie">Doktoranckie</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="salary">üí∞ Oczekiwania p≈Çacowe</label>
                    <select id="salary">
                        <option value="">Dowolne</option>
                        <option value="3000-5000">3 000 - 5 000 z≈Ç</option>
                        <option value="5000-8000">5 000 - 8 000 z≈Ç</option>
                        <option value="8000-12000">8 000 - 12 000 z≈Ç</option>
                        <option value="12000-20000">12 000 - 20 000 z≈Ç</option>
                        <option value="20000+">20 000+ z≈Ç</option>
                    </select>
                </div>
            </form>
            
            <div class="search-buttons">
                <button type="button" class="search-btn" onclick="searchCVs()">
                    üîç Szukaj kandydat√≥w
                </button>
                <button type="button" class="search-btn clear-btn" onclick="clearSearch()">
                    üóëÔ∏è Wyczy≈õƒá filtry
                </button>
            </div>
        </section>
        
        <!-- Results Section -->
        <section class="results-section">
            <div class="results-header">
                <h2 class="results-title">üìã Wyniki wyszukiwania</h2>
                <div class="results-count" id="resultsCount">Pokazano 0 kandydat√≥w</div>
                <div class="sort-controls">
                    <label for="sortBy" style="color: #00ff00; margin-right: 0.5rem;">Sortuj:</label>
                    <select id="sortBy" class="sort-select" onchange="sortResults()">
                        <option value="newest">Najnowsze</option>
                        <option value="experience">Do≈õwiadczenie</option>
                        <option value="alphabetical">Alfabetycznie</option>
                        <option value="location">Lokalizacja</option>
                    </select>
                </div>
            </div>
            
            <!-- Loading indicator -->
            <div class="loading" id="loadingIndicator" style="display: none;">
                <div class="spinner"></div>
                <p>Wyszukiwanie kandydat√≥w...</p>
            </div>
            
            <!-- CV Cards Container -->
            <div class="cv-grid" id="cvGrid">
                <!-- CV cards will be loaded here -->
            </div>
            
            <!-- No Results -->
            <div class="no-results" id="noResults" style="display: none;">
                <div class="no-results-icon">üîç</div>
                <h3>Brak wynik√≥w</h3>
                <p>Nie znaleziono kandydat√≥w spe≈ÇniajƒÖcych podane kryteria.<br>
                Spr√≥buj zmieniƒá filtry wyszukiwania lub wpisaƒá inne s≈Çowa kluczowe.</p>
            </div>
            
            <!-- Pagination -->
            <div class="pagination" id="pagination" style="display: none;">
                <button onclick="previousPage()" id="prevBtn">‚Üê Poprzednia</button>
                <span id="pageInfo">Strona 1 z 1</span>
                <button onclick="nextPage()" id="nextBtn">Nastƒôpna ‚Üí</button>
            </div>
        </section>
    </div>
    
    <script>
        // Global variables
        let allCVs = [];
        let filteredCVs = [];
        let currentPage = 1;
        const itemsPerPage = 12;
        
        // Sample CV data
        function loadSampleData() {
            allCVs = [
                {
                    id: 1,
                    name: "Anna Kowalska",
                    position: "Frontend Developer",
                    location: "Warszawa",
                    experience: "3-5",
                    education: "Wy≈ºsze",
                    salary: "8000-12000",
                    skills: ["JavaScript", "React", "CSS", "HTML", "TypeScript"],
                    summary: "Do≈õwiadczona frontend developerka z pasjƒÖ do tworzenia nowoczesnych interfejs√≥w u≈ºytkownika. Specjalizuje siƒô w React i nowoczesnych technologiach webowych.",
                    yearsExp: "4 lata",
                    email: "anna.kowalska@example.com",
                    phone: "+48 123 456 789",
                    addedDate: "2024-01-15"
                },
                {
                    id: 2,
                    name: "Marcin Nowak",
                    position: "Backend Developer",
                    location: "Krak√≥w",
                    experience: "5-10",
                    education: "Magisterskie",
                    salary: "12000-20000",
                    skills: ["Python", "Django", "PostgreSQL", "Docker", "AWS"],
                    summary: "Senior backend developer z 7-letnim do≈õwiadczeniem w budowaniu skalowalnych aplikacji. Expert w Python i architekturze mikrous≈Çug.",
                    yearsExp: "7 lat",
                    email: "marcin.nowak@example.com",
                    phone: "+48 987 654 321",
                    addedDate: "2024-01-14"
                },
                {
                    id: 3,
                    name: "Katarzyna Wi≈õniewska",
                    position: "UX/UI Designer",
                    location: "Gda≈Ñsk",
                    experience: "1-3",
                    education: "Wy≈ºsze",
                    salary: "5000-8000",
                    skills: ["Figma", "Adobe XD", "Sketch", "Prototyping", "User Research"],
                    summary: "Kreatywna projektantka UX/UI z okiem do detali. Tworzy intuicyjne i atrakcyjne interfejsy u≈ºytkownika oparte na badaniach potrzeb u≈ºytkownik√≥w.",
                    yearsExp: "2 lata",
                    email: "katarzyna.wisniewska@example.com",
                    phone: "+48 456 789 123",
                    addedDate: "2024-01-13"
                },
                {
                    id: 4,
                    name: "Piotr Jankowski",
                    position: "DevOps Engineer",
                    location: "Wroc≈Çaw",
                    experience: "5-10",
                    education: "Wy≈ºsze",
                    salary: "12000-20000",
                    skills: ["Kubernetes", "Docker", "Jenkins", "AWS", "Terraform"],
                    summary: "Do≈õwiadczony in≈ºynier DevOps specjalizujƒÖcy siƒô w automatyzacji proces√≥w CI/CD i zarzƒÖdzaniu infrastrukturƒÖ w chmurze.",
                    yearsExp: "6 lat",
                    email: "piotr.jankowski@example.com",
                    phone: "+48 789 123 456",
                    addedDate: "2024-01-12"
                },
                {
                    id: 5,
                    name: "Magdalena Zieli≈Ñska",
                    position: "Marketing Manager",
                    location: "Pozna≈Ñ",
                    experience: "3-5",
                    education: "Magisterskie",
                    salary: "8000-12000",
                    skills: ["Digital Marketing", "SEO", "Google Ads", "Analytics", "Content Marketing"],
                    summary: "Dynamiczna menad≈ºerka marketingu z do≈õwiadczeniem w prowadzeniu kampanii digitalowych i budowaniu strategii marki w ≈õrodowisku online.",
                    yearsExp: "4 lata",
                    email: "magdalena.zielinska@example.com",
                    phone: "+48 321 654 987",
                    addedDate: "2024-01-11"
                },
                {
                    id: 6,
                    name: "Tomasz Kaczmarek",
                    position: "Data Analyst",
                    location: "Warszawa",
                    experience: "1-3",
                    education: "Wy≈ºsze",
                    salary: "5000-8000",
                    skills: ["Python", "SQL", "Tableau", "Excel", "Power BI"],
                    summary: "Analityk danych z pasjƒÖ do odkrywania insights z du≈ºych zbior√≥w danych. Do≈õwiadczenie w tworzeniu raport√≥w i wizualizacji biznesowych.",
                    yearsExp: "2 lata",
                    email: "tomasz.kaczmarek@example.com",
                    phone: "+48 654 987 321",
                    addedDate: "2024-01-10"
                },
                {
                    id: 7,
                    name: "Agnieszka Lewandowska",
                    position: "Project Manager",
                    location: "≈Å√≥d≈∫",
                    experience: "5-10",
                    education: "Magisterskie",
                    salary: "10000-15000",
                    skills: ["Scrum", "Agile", "JIRA", "Risk Management", "Team Leadership"],
                    summary: "Do≈õwiadczona kierownik projekt√≥w IT z certyfikatem PMP. Skutecznie zarzƒÖdza zespo≈Çami wielokulturowymi i projektami o wysokiej z≈Ço≈ºono≈õci.",
                    yearsExp: "8 lat",
                    email: "agnieszka.lewandowska@example.com",
                    phone: "+48 111 222 333",
                    addedDate: "2024-01-09"
                },
                {
                    id: 8,
                    name: "Robert Kowal",
                    position: "Cybersecurity Specialist",
                    location: "Katowice",
                    experience: "3-5",
                    education: "Wy≈ºsze",
                    salary: "9000-13000",
                    skills: ["Network Security", "Penetration Testing", "CISSP", "Firewall", "Incident Response"],
                    summary: "Specjalista ds. cyberbezpiecze≈Ñstwa z do≈õwiadczeniem w ochronie infrastruktury IT. Certyfikowany ethical hacker z umiejƒôtno≈õciami w penetration testing.",
                    yearsExp: "5 lat",
                    email: "robert.kowal@example.com",
                    phone: "+48 444 555 666",
                    addedDate: "2024-01-08"
                }
            ];
            
            // Display all CVs initially
            filteredCVs = [...allCVs];
            displayCVs();
        }
        
        // Search function
        function searchCVs() {
            const keyword = document.getElementById('keyword').value.toLowerCase();
            const position = document.getElementById('position').value.toLowerCase();
            const location = document.getElementById('location').value;
            const experience = document.getElementById('experience').value;
            const education = document.getElementById('education').value;
            const salary = document.getElementById('salary').value;
            
            // Show loading
            showLoading(true);
            
            setTimeout(() => {
                filteredCVs = allCVs.filter(cv => {
                    const matchKeyword = !keyword || 
                        cv.name.toLowerCase().includes(keyword) ||
                        cv.position.toLowerCase().includes(keyword) ||
                        cv.skills.some(skill => skill.toLowerCase().includes(keyword)) ||
                        cv.summary.toLowerCase().includes(keyword);
                    
                    const matchPosition = !position || cv.position.toLowerCase().includes(position);
                    const matchLocation = !location || cv.location === location;
                    const matchExperience = !experience || cv.experience === experience;
                    const matchEducation = !education || cv.education === education;
                    const matchSalary = !salary || cv.salary === salary;
                    
                    return matchKeyword && matchPosition && matchLocation && 
                           matchExperience && matchEducation && matchSalary;
                });
                
                currentPage = 1;
                showLoading(false);
                displayCVs();
            }, 1000);
        }
        
        // Clear search function
        function clearSearch() {
            document.getElementById('searchForm').reset();
            filteredCVs = [...allCVs];
            currentPage = 1;
            displayCVs();
        }
        
        // Display CVs function
        function displayCVs() {
            const grid = document.getElementById('cvGrid');
            const resultsCount = document.getElementById('resultsCount');
            const noResults = document.getElementById('noResults');
            const pagination = document.getElementById('pagination');
            
            // Calculate pagination
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedCVs = filteredCVs.slice(startIndex, endIndex);
            
            // Update results count
            resultsCount.textContent = `Pokazano ${filteredCVs.length} kandydat√≥w`;
            
            if (filteredCVs.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                pagination.style.display = 'none';
                return;
            }
            
            grid.style.display = 'grid';
            noResults.style.display = 'none';
            
            // Generate CV cards
            grid.innerHTML = paginatedCVs.map(cv => `
                <div class="cv-card">
                    <div class="cv-header">
                        <div>
                            <div class="cv-name">${cv.name}</div>
                            <div class="cv-position">${cv.position}</div>
                            <div class="cv-location">üìç ${cv.location}</div>
                        </div>
                        <div class="cv-experience">${cv.yearsExp}</div>
                    </div>
                    
                    <div class="cv-details">
                        <div class="cv-section">
                            <div class="cv-section-title">üéØ Umiejƒôtno≈õci</div>
                            <div class="skills-list">
                                ${cv.skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('')}
                            </div>
                        </div>
                        
                        <div class="cv-section">
                            <div class="cv-section-title">üìù O kandydacie</div>
                            <div class="cv-summary">${cv.summary}</div>
                        </div>
                        
                        <div class="cv-section">
                            <div class="cv-section-title">üéì Wykszta≈Çcenie</div>
                            <div style="color: #ccc;">${cv.education}</div>
                        </div>
                        
                        <div class="cv-section">
                            <div class="cv-section-title">üí∞ Oczekiwania</div>
                            <div style="color: #00fff7; font-weight: bold;">${getSalaryText(cv.salary)}</div>
                        </div>
                    </div>
                    
                    <div class="cv-actions">
                        <a href="#" class="action-btn view-btn" onclick="viewCV(${cv.id})">
                            üëÅÔ∏è Zobacz CV
                        </a>
                        <a href="#" class="action-btn contact-btn" onclick="contactCandidate(${cv.id})">
                            üìß Kontakt
                        </a>
                        <a href="#" class="action-btn save-btn" onclick="saveCandidate(${cv.id})">
                            ‚≠ê Zapisz
                        </a>
                    </div>
                </div>
            `).join('');
            
            // Update pagination
            updatePagination();
        }
        
        // Helper function to get salary text
        function getSalaryText(salaryRange) {
            const salaryMap = {
                '3000-5000': '3 000 - 5 000 z≈Ç',
                '5000-8000': '5 000 - 8 000 z≈Ç',
                '8000-12000': '8 000 - 12 000 z≈Ç',
                '12000-20000': '12 000 - 20 000 z≈Ç',
                '20000+': '20 000+ z≈Ç'
            };
            return salaryMap[salaryRange] || 'Do uzgodnienia';
        }
        
        // Sort results function
        function sortResults() {
            const sortBy = document.getElementById('sortBy').value;
            
            switch(sortBy) {
                case 'newest':
                    filteredCVs.sort((a, b) => new Date(b.addedDate) - new Date(a.addedDate));
                    break;
                case 'experience':
                    filteredCVs.sort((a, b) => {
                        const expA = parseInt(a.yearsExp);
                        const expB = parseInt(b.yearsExp);
                        return expB - expA;
                    });
                    break;
                case 'alphabetical':
                    filteredCVs.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'location':
                    filteredCVs.sort((a, b) => a.location.localeCompare(b.location));
                    break;
            }
            
            currentPage = 1;
            displayCVs();
        }
        
        // Pagination functions
        function updatePagination() {
            const pagination = document.getElementById('pagination');
            const pageInfo = document.getElementById('pageInfo');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            const totalPages = Math.ceil(filteredCVs.length / itemsPerPage);
            
            if (totalPages <= 1) {
                pagination.style.display = 'none';
                return;
            }
            
            pagination.style.display = 'flex';
            pageInfo.textContent = `Strona ${currentPage} z ${totalPages}`;
            
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
        }
        
        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                displayCVs();
            }
        }
        
        function nextPage() {
            const totalPages = Math.ceil(filteredCVs.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayCVs();
            }
        }
        
        // CV action functions
        function viewCV(cvId) {
            const cv = allCVs.find(c => c.id === cvId);
            if (cv) {
                alert(`üîç Otwieranie pe≈Çnego CV: ${cv.name}\n\nüìß Email: ${cv.email}\nüìû Telefon: ${cv.phone}\n\nüíº ${cv.position}\nüìç ${cv.location}\n\n${cv.summary}`);
            }
        }
        
        function contactCandidate(cvId) {
            const cv = allCVs.find(c => c.id === cvId);
            if (cv) {
                alert(`üìß Kontakt z kandydatem: ${cv.name}\n\nEmail: ${cv.email}\nTelefon: ${cv.phone}\n\nFunkcja kontaktu zostanie wkr√≥tce uruchomiona!`);
            }
        }
        
        function saveCandidate(cvId) {
            const cv = allCVs.find(c => c.id === cvId);
            if (cv) {
                alert(`‚≠ê Kandydat ${cv.name} zosta≈Ç zapisany w Twoich ulubionych!\n\nMo≈ºesz znale≈∫ƒá go w sekcji "Zapisani kandydaci".`);
            }
        }
        
        // Loading indicator
        function showLoading(show) {
            const loading = document.getElementById('loadingIndicator');
            const grid = document.getElementById('cvGrid');
            
            if (show) {
                loading.style.display = 'block';
                grid.style.display = 'none';
            } else {
                loading.style.display = 'none';
                grid.style.display = 'grid';
            }
        }
        
        // Test function to simulate plan change (for testing purposes)
        window.testPlanChange = function(newPlan) {
            const userData = sessionStorage.getItem('currentUser');
            if (userData) {
                const user = JSON.parse(userData);
                console.log('üß™ TEST: Changing plan from', user.plan, 'to', newPlan);
                user.plan = newPlan;
                sessionStorage.setItem('currentUser', JSON.stringify(user));
                console.log('üß™ TEST: Plan changed, calling ultimatePlanSync');
                ultimatePlanSync();
            } else {
                console.log('üß™ TEST: No user data found');
            }
        };
        
        // Force synchronization function
        window.forcePlanSync = function() {
            console.log('üîÑ FORCE SYNC: Starting forced ultimatePlanSync...');
            ultimatePlanSync();
        };
        
        // Debug function to show current state
        window.debugUserState = function() {
            const userData = sessionStorage.getItem('currentUser');
            const userInfo = document.getElementById('userWelcome');
            const userPlan = document.getElementById('userPlan');
            
            console.log('=== DEBUG USER STATE ===');
            console.log('SessionStorage currentUser:', userData);
            if (userData) {
                const user = JSON.parse(userData);
                console.log('Parsed user data:', user);
                console.log('User plan from data:', user.plan);
            }
            console.log('userWelcome element:', userInfo);
            console.log('userWelcome content:', userInfo?.innerHTML);
            console.log('userPlan element:', userPlan);
            console.log('userPlan content:', userPlan?.innerHTML);
            
            // Check for plan mismatch
            if (userData) {
                const user = JSON.parse(userData);
                const currentPlanDisplay = userPlan?.innerHTML || '';
                if (!currentPlanDisplay.includes(user.plan)) {
                    console.warn('‚ö†Ô∏è PLAN MISMATCH DETECTED!');
                    console.warn('Data says:', user.plan);
                    console.warn('Display shows:', currentPlanDisplay);
                    console.warn('Forcing ultimatePlanSync...');
                    ultimatePlanSync();
                }
            }
            console.log('========================');
            
            return {
                userData: userData ? JSON.parse(userData) : null,
                userWelcomeContent: userInfo?.innerHTML,
                userPlanContent: userPlan?.innerHTML
            };
        };
        
        // === TEST FUNCTIONS FOR DEBUGGING ===
        function testEnterprisePlan() {
            console.log('üèõÔ∏è Testing Enterprise plan...');
            const testData = {
                name: 'test@ecvjob.pl',
                email: 'test@ecvjob.pl',
                plan: 'Enterprise',
                planIcon: 'üèõÔ∏è'
            };
            sessionStorage.setItem('currentUser', JSON.stringify(testData));
            localStorage.setItem('currentUser', JSON.stringify(testData));
            sessionStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('isLoggedIn', 'true');
            ultimatePlanSync();
            console.log('‚úÖ Enterprise plan test completed');
            location.reload(); // Reload page to apply changes
        }

        function setupTestEnterpriseAccount() {
            console.log('üîß Setting up test Enterprise account for test@ecvjob.pl...');
            const testData = {
                name: 'test@ecvjob.pl',
                email: 'test@ecvjob.pl',
                plan: 'Enterprise',
                planIcon: 'üèõÔ∏è'
            };
            sessionStorage.setItem('currentUser', JSON.stringify(testData));
            localStorage.setItem('currentUser', JSON.stringify(testData));
            sessionStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('isLoggedIn', 'true');
            console.log('‚úÖ Test Enterprise account set up:', testData);
            return testData;
        }

        function testBusinessPlan() {
            console.log('üè¢ Testing Business plan...');
            const testData = {
                name: 'Business User',
                plan: 'Business',
                planIcon: 'üè¢'
            };
            sessionStorage.setItem('currentUser', JSON.stringify(testData));
            localStorage.setItem('currentUser', JSON.stringify(testData));
            ultimatePlanSync();
            console.log('‚úÖ Business plan test completed');
        }

        function testPremiumPlan() {
            console.log('üíé Testing Premium plan...');
            const testData = {
                name: 'Premium User',
                plan: 'Premium',
                planIcon: 'üíé'
            };
            sessionStorage.setItem('currentUser', JSON.stringify(testData));
            localStorage.setItem('currentUser', JSON.stringify(testData));
            ultimatePlanSync();
            console.log('‚úÖ Premium plan test completed');
        }

        function showAllowedPlans() {
            const allowedPlans = ['Premium', 'Business', 'Enterprise'];
            console.log('üîê Allowed plans for CV Database access:', allowedPlans);
            return allowedPlans;
        }
        
        // Expose functions globally for external access
        window.updateUserPlanDisplay = updateUserPlanDisplay;
        window.ultimatePlanSync = ultimatePlanSync;
        window.testEnterprisePlan = testEnterprisePlan;
        window.testBusinessPlan = testBusinessPlan;
        window.testPremiumPlan = testPremiumPlan;
        window.setupTestEnterpriseAccount = setupTestEnterpriseAccount;
        window.showAllowedPlans = showAllowedPlans;

        console.log('üîß CV Database loaded. Test functions available:');
        console.log('- setupTestEnterpriseAccount() - Set up test@ecvjob.pl with Enterprise');
        console.log('- testEnterprisePlan() - Test Enterprise plan access');
        console.log('- testBusinessPlan() - Test Business plan access');
        console.log('- testPremiumPlan() - Test Premium plan access');
        console.log('- showAllowedPlans() - Show which plans have access');
        console.log('- ultimatePlanSync() - Force plan refresh');
        
        // Auto-setup Enterprise account if this is the first load
        if (!sessionStorage.getItem('currentUser')) {
            console.log('üîß Auto-setting up Enterprise test account...');
            setupTestEnterpriseAccount();
        } else {
            // Always force Enterprise for test account
            console.log('üîß Ensuring Enterprise setup for existing user...');
            const existingUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
            if (existingUser.name === 'test@ecvjob.pl' || !existingUser.plan || existingUser.plan !== 'Enterprise') {
                console.log('üîß Forcing Enterprise setup...');
                setupTestEnterpriseAccount();
            }
        }
        
        // Additional immediate Enterprise setup
        console.log('üö® FINAL ENTERPRISE SETUP - This runs immediately!');
        const finalTestData = {
            name: 'test@ecvjob.pl',
            email: 'test@ecvjob.pl',
            plan: 'Enterprise',
            planIcon: 'üèõÔ∏è',
            userId: 'test-enterprise-user',
            setupTime: new Date().toISOString()
        };
        
        sessionStorage.setItem('currentUser', JSON.stringify(finalTestData));
        sessionStorage.setItem('isLoggedIn', 'true');
        localStorage.setItem('currentUser', JSON.stringify(finalTestData));
        localStorage.setItem('isLoggedIn', 'true');
        
        console.log('‚úÖ FINAL SETUP COMPLETED - Enterprise account ready:', finalTestData);
        console.log('‚úÖ Page should now work with Enterprise access!');
    </script>
        <script>
            // Obs≈Çuga przycisku Wstecz (z fallbackiem)
            document.addEventListener('DOMContentLoaded', function(){
                var btn = document.getElementById('backBtn');
                if (btn) {
                    btn.addEventListener('click', function(){
                        if (history.length > 1) { history.back(); }
                        else { location.href = 'index.html'; }
                    });
                }
            });
        </script>
</body>
</html>
