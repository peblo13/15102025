<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- PapaParse do CSV -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <meta name="description" content="Usługi - eCVjob.pl. Znajdź lub dodaj usługę z naszej bazy.">
    <meta name="keywords" content="usługi, praca, oferty usług, eCVjob">
    <title>Usługi - eCVjob.pl</title>
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="preload" href="./images/tlo.jpg" as="image">
    <style>
        /* --- Paginacja: identyczny styl jak oferty-pracy.html --- */
                .pagination-bar {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          align-items: center;
          gap: 8px;
          margin: 30px 0;
          padding: 20px;
          background: rgba(0,0,0,0.8);
          border-radius: 15px;
          border: 2px solid #00ff00;
          box-shadow: 0 4px 20px rgba(0,255,0,0.3);
                    overflow: hidden; /* zapobiega nachodzeniu krawędzi i wyciekom efektów */
        }
        .pagination-btn {
          position: relative;
          overflow: hidden;
          padding: 12px 18px;
          border: 2px solid #00ff00;
          background: rgba(0,0,0,0.8);
          color: #00ff00;
          border-radius: 8px;
          cursor: pointer;
          font-weight: bold;
          transition: all 0.3s ease;
          min-width: 45px;
          text-align: center;
        }
        .pagination-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(0,255,0,0.3), transparent);
          transition: left 0.5s;
          z-index: 1;
        }
        .pagination-btn:hover::before {
          left: 100%;
        }
        .pagination-btn:active {
          transform: scale(0.95);
        }
        .pagination-btn .ripple {
          position: absolute;
          border-radius: 50%;
          background: rgba(0,255,0,0.6);
          transform: scale(0);
          animation: ripple 0.6s linear;
          z-index: 1;
        }
        @keyframes ripple {
          to {
            transform: scale(4);
            opacity: 0;
          }
        }
        .pagination-btn:hover:not(:disabled) {
          background: rgba(0,255,0,0.2);
          box-shadow: 0 0 15px rgba(0,255,0,0.5);
          transform: translateY(-2px);
        }
        .pagination-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          transform: none;
        }
        .pagination-btn.active {
          background: #00ff00;
          color: #111;
          box-shadow: 0 0 20px rgba(0,255,0,0.8);
          transform: scale(1.1);
        }
        .pagination-jump-input {
          padding: 8px 12px;
          background: rgba(0,0,0,0.8);
          border: 2px solid #00ff00;
          color: #00ff00;
          border-radius: 6px;
          font-size: 14px;
          text-align: center;
          outline: none;
          transition: all 0.3s ease;
          position: relative;
          z-index: 1;
        }
        .pagination-jump-input:focus {
          background: rgba(0,255,0,0.1);
          box-shadow: 0 0 10px rgba(0,255,0,0.5);
        }
        .pagination-jump-btn {
          padding: 8px 16px;
          background: rgba(0,0,0,0.8);
          border: 2px solid #ff2222;
          color: #ff2222;
          border-radius: 6px;
          cursor: pointer;
          font-weight: bold;
          transition: all 0.3s ease;
          font-size: 14px;
          position: relative;
          overflow: hidden;
          z-index: 1;
        }
        .pagination-jump-btn:hover:not(:disabled) {
          background: #ff2222;
          color: #111;
          border-color: #ff2222;
          box-shadow: 0 0 18px #ff2222, 0 0 36px #ff2222;
        }
        .pagination-advanced-nav {
          background: rgba(0,255,0,0.1);
          border: 1px solid #00ff00;
          border-radius: 10px;
          padding: 8px 15px;
          margin-left: 20px;
        }
        .pagination-position-info {
          color: #00ff00;
          font-size: 0.9rem;
          font-weight: bold;
          text-shadow: 0 0 5px #00ff00;
        }
        .pagination-quick-select {
          background: rgba(0,0,0,0.8);
          border: 2px solid #00ff00;
          color: #00ff00;
          border-radius: 6px;
          padding: 4px 8px;
          font-size: 0.9rem;
          min-width: 80px;
          outline: none;
          transition: all 0.3s ease;
        }
        .pagination-quick-select:hover {
          background: rgba(0,255,0,0.1);
          box-shadow: 0 0 10px #00ff00;
        }
        .pagination-quick-select:focus {
          background: rgba(0,255,0,0.15);
          box-shadow: 0 0 15px #00ff00;
        }
        .pagination-navigation-btn {
          background: rgba(0,0,0,0.8);
          border: 2px solid #FFD700;
          color: #FFD700;
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 1rem;
          cursor: pointer;
          transition: all 0.3s ease;
          text-shadow: 0 0 5px #FFD700;
        }
        .pagination-navigation-btn:hover:not(:disabled) {
          background: rgba(255,215,0,0.2);
          box-shadow: 0 0 15px #FFD700;
          transform: scale(1.05);
        }
        .pagination-navigation-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          box-shadow: none;
        }
        .pagination-separator {
          color: #00ff00;
          margin: 0 8px;
          font-weight: bold;
          text-shadow: 0 0 5px #00ff00;
        }
        .pagination-jump-label {
          color: #00ff00;
          font-size: 0.9rem;
          font-weight: bold;
          text-shadow: 0 0 5px #00ff00;
        }
        /* Karta premium - złota ramka, animacja, nakładka */
        .premium-card {
            border: 3px solid gold !important;
            box-shadow: 0 0 40px gold, 0 0 32px 8px #FFD70099 !important;
            background: rgba(30,30,0,0.18) !important;
            position: relative;
            animation: premium-glow 2s infinite alternate;
            overflow: hidden;
        }
        /* Odstęp pod etykietą PREMIUM, by tytuł nie nachodził na label */
        .premium-card .job-title {
            padding-top: 32px;
        }
        /* Półprzezroczysta czarna nakładka na kartę premium */
        .premium-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 1;
            pointer-events: none;
            /* Usunięto opacity, zostaje tylko złota poświata */
            box-shadow: 0 0 32px 8px #FFD70099, 0 0 12px 2px #FFD70055;
        }

        /* Styl napisu PREMIUM */
        .premium-label {
            position: absolute;
            top: -18px;
            left: -18px;
            background: linear-gradient(90deg, #FFD700 60%, #FFB300 100%);
            color: #111;
            font-weight: bold;
            padding: 10px 32px;
            border-radius: 22px 0 22px 0;
            font-size: 1.45rem;
            z-index: 2;
            box-shadow: 0 0 32px 8px #FFD700cc, 0 0 18px #fff, 0 2px 8px #FFD70099;
            letter-spacing: 2.5px;
            text-shadow: 0 2px 12px #fff, 0 0 8px #FFD700, 0 1px 0 #fff;
            border: 2.5px solid #fff6;
            filter: drop-shadow(0 2px 8px #FFD700cc);
            transition: transform 0.2s;
        }
        .premium-label:hover {
            transform: scale(1.04) rotate(-2deg);
            box-shadow: 0 0 40px 12px #FFD700ee, 0 0 24px #fff, 0 2px 12px #FFD700cc;
        }
        @keyframes premium-glow {
            0% { box-shadow: 0 0 40px gold, 0 0 0px #FFD700; }
            100% { box-shadow: 0 0 60px #FFD700, 0 0 20px gold; }
        }
        body {
            font-family: Arial, sans-serif;
            background: url("images/tlo.jpg") no-repeat center center fixed;
            background-size: cover;
            color: #fff;
            min-height: 100vh;
            line-height: 1.6;
        }
        /* Fixed, fitted background on small screens */
        @media (max-width: 768px) {
            body { background: transparent !important; }
            body::before {
                content: '';
                position: fixed;
                top: 0; left: 0; right: 0; bottom: 0;
                background: url('images/tlo.jpg') no-repeat center center;
                background-size: cover;
                z-index: -1;
                pointer-events: none;
                transform: translateZ(0);
            }
        }
        /* Globalny przycisk Wstecz (zawsze widoczny) */
        .back-btn { position: fixed; top: calc(14px + env(safe-area-inset-top)); left: 14px; z-index: 9999; background: rgba(0,0,0,0.8); color:#00ff00; border:2px solid #00ff00; border-radius: 12px; padding: 10px 14px; font-weight: 800; letter-spacing: .5px; box-shadow: 0 6px 24px rgba(0,255,0,.25); cursor: pointer; }
        .back-btn:active { transform: scale(.98) }
        @media (max-width: 768px) { .back-btn { font-size: 14px } }
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        /* Mobile dopracowanie paginacji (iPhone) */
        @media (max-width: 600px) {
            .pagination-bar { padding: 12px 10px; gap: 6px; border-radius: 12px; }
            .pagination-btn { padding: 10px 12px; min-width: 38px; border-radius: 8px; }
            .pagination-advanced-nav { width: 100%; margin-left: 0; justify-content: center; flex-wrap: wrap; gap: 8px; }
            .pagination-jump-input { width: 56px; }
            .pagination-jump-btn { padding: 8px 10px; }
        }
    /* .main-container i .logo są już poniżej, usuwamy powielenie */
        .add-service-btn {
            background: linear-gradient(100deg, #00ff00 0%, #FFD700 40%, #FF9100 100%);
            color: #fff;
            font-size: 2.7rem;
            font-weight: bold;
            padding: 32px 100px;
            border: none;
            border-radius: 48px;
            box-shadow: 0 12px 48px 0 #FFD700cc, 0 4px 24px 0 #00ff0033, 0 0 0 16px #FFD70033;
            cursor: pointer;
            margin-bottom: 32px;
            transition: background 0.22s, box-shadow 0.22s, transform 0.18s, color 0.18s;
            letter-spacing: 2.5px;
            position: relative;
            z-index: 2;
            outline: 4px solid #FFD70077;
            text-shadow: 0 4px 24px #FFD700cc, 0 0 16px #fff;
            display: inline-block;
            margin-left: auto;
            margin-right: auto;
            max-width: 92vw; /* nie wychodzi poza ekran */
            user-select: none;
        }
        .add-service-btn:hover, .add-service-btn:focus {
            background: linear-gradient(100deg, #FFD700 0%, #00ff00 60%, #00e676 100%);
            color: #111;
            box-shadow: 0 24px 80px 0 #FFD700ee, 0 2px 22px 0 #00ff0033, 0 0 0 18px #FFD70044;
            outline: 5px solid #FFD700;
            transform: scale(1.06) translateY(-4px);
            text-shadow: 0 8px 28px #FFD700ee, 0 0 18px #fff;
        }
        .add-service-btn:active {
            transform: scale(0.97) translateY(2px);
            box-shadow: 0 2px 8px #FFD70077;
        }
        @media (max-width: 700px) {
            .add-service-btn {
                font-size: 1.2rem;
                padding: 16px 18px;
                border-radius: 18px;
                width: 90vw; /* precyzyjne wyśrodkowanie i ucięcie efektów na krawędziach */
                box-shadow: 0 8px 28px 0 #FFD700aa, 0 2px 12px 0 #00ff0033; /* mniejsze poświaty na mobile */
                outline: 3px solid #FFD70055;
            }
        }
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: rgba(0,0,0,0.7);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #333;
            transition: all 0.3s;
        }
        .stat-card:hover {
            border-color: #00ff00;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,255,0,0.2);
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00ff00;
            margin-bottom: 10px;
        }
        .stat-label {
            color: #ccc;
            font-size: 1.1rem;
        }
        .services-section {
            margin-bottom: 40px;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .service-actions {
            display: flex;
            gap: 15px;
        }
        .btn-contact {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #111;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-contact:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,255,0,0.4);
        }
        .btn-details {
            background: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-details:hover {
            background: #00ff00;
            color: #111;
        }
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #00ff00;
            font-size: 1.2rem;
        }
        .spinner {
            border: 4px solid #333;
            border-top: 4px solid #00ff00;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .service-cards-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: 1fr;
            margin-bottom: 30px;
        }

        /* Usunięto powielone definicje premium-card i premium-glow */
        .job-card {
            background: rgba(0,0,0,0.7);
            border: 2px solid #333;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s;
            cursor: pointer;
        }
        .job-card:hover {
            border-color: #00ff00;
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,255,0,0.2);
        }
        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        .job-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }
        .job-company {
            color: #00ff00;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .job-description {
            color: #ccc;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        .job-actions {
            display: flex;
            gap: 15px;
        }
        .btn-contact {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #111;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-contact:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,255,0,0.4);
        }
        .btn-details {
            background: transparent;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-details:hover {
            background: #00ff00;
            color: #111;
        }
        .services-count {
            background: #00ff00;
            color: #111;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            margin-left: 10px;
            box-shadow: 0 2px 12px #00ff0033;
            display: inline-block;
            min-width: 60px;
            text-align: center;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>
    <!-- Dekoracyjne logo po prawej stronie, pod wszystkimi sekcjami -->
    <img src="images/logo.png" alt="Logo" style="position:fixed; top:80px; right:0; width:180px; opacity:0.13; z-index:0; pointer-events:none; user-select:none;" />
    <!-- Przycisk Wstecz zamiast paska nawigacji -->
    <button id="backBtn" class="back-btn" type="button" aria-label="Wróć">← Wstecz</button>
    <main class="main-container">
        <div style="text-align:center; margin-bottom: 30px;">
            <button id="addServiceBtn" class="add-service-btn" type="button"
                style="
                    background: linear-gradient(100deg, #00ff00 0%, #FFD700 40%, #FF9100 100%);
                    color: #fff;
                    font-size: 2.7rem;
                    font-weight: bold;
                    padding: 32px 100px;
                    border: none;
                    border-radius: 48px;
                    box-shadow: 0 12px 48px 0 #FFD700cc, 0 4px 24px 0 #00ff0033, 0 0 0 16px #FFD70033;
                    cursor: pointer;
                    margin-bottom: 32px;
                    letter-spacing: 2.5px;
                    outline: 4px solid #FFD70077;
                    text-shadow: 0 4px 24px #FFD700cc, 0 0 16px #fff;
                    display: inline-block;
                    user-select: none;
                    transition: background 0.22s, box-shadow 0.22s, transform 0.18s, color 0.18s;
                "
            >Dodaj usługę</button>
                        <div id="addServiceModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.85); z-index:99999; justify-content:center; align-items:center;">
                            <div id="addServiceCard" style="background:#1b1f1c; padding:30px 26px; border-radius:22px; max-width:980px; width:96%; box-shadow:0 8px 40px #00ff0033; color:#fff; position:relative; max-height:92vh; overflow-y:auto; display:flex; flex-direction:column; border:2px solid #00ff00;">
                                <button id="closeAddServiceModalBtn" type="button" style="position:absolute; top:14px; right:14px; background:none; border:none; color:#00ff00; font-size:2.2rem; cursor:pointer;">&times;</button>
                                <h2 style="color:#00ff00; margin:6px 0 18px 0; text-align:center; letter-spacing:1px;">Dodaj usługę</h2>
                                <form id="addServiceForm" style="display:grid; grid-template-columns: 1fr 1fr; gap:18px;">
                                    <fieldset style="grid-column:1 / -1; border:1px solid #00ff00; border-radius:12px; padding:14px;">
                                        <legend style="color:#00ff00; padding:0 8px;">Podstawowe informacje</legend>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:14px;">
                                            <div>
                                                <label for="modalNazwa" style="color:#00ff00; font-weight:bold;">Nazwa usługi*</label>
                                                <input type="text" id="modalNazwa" required style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label for="modalKategoria" style="color:#00ff00; font-weight:bold;">Kategoria*</label>
                                                <select id="modalKategoria" required style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                                    <option value="">-- wybierz --</option>
                                                    <option>IT</option>
                                                    <option>Budownictwo</option>
                                                    <option>Marketing</option>
                                                    <option>Księgowość</option>
                                                    <option>Grafika</option>
                                                    <option>Prawo</option>
                                                    <option>Tłumaczenia</option>
                                                    <option>Sprzątanie</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label for="modalPodkategoria" style="color:#00ff00; font-weight:bold;">Podkategoria</label>
                                                <select id="modalPodkategoria" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;"></select>
                                            </div>
                                            <div>
                                                <label for="modalTagi" style="color:#00ff00; font-weight:bold;">Tagi (po przecinku)</label>
                                                <input type="text" id="modalTagi" placeholder="np. www, seo, sklep" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div style="grid-column:1/-1;">
                                                <label for="modalOpis" style="color:#00ff00; font-weight:bold;">Opis usługi*</label>
                                                <textarea id="modalOpis" required rows="4" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;"></textarea>
                                            </div>
                                            <div style="grid-column:1/-1;">
                                                <label for="modalZakres" style="color:#00ff00; font-weight:bold;">Zakres prac (szczegóły)</label>
                                                <textarea id="modalZakres" rows="3" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;"></textarea>
                                            </div>
                                        </div>
                                    </fieldset>

                                    <fieldset style="grid-column:1 / -1; border:1px solid #00ff00; border-radius:12px; padding:14px;">
                                        <legend style="color:#00ff00; padding:0 8px;">Lokalizacja i realizacja</legend>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap:14px;">
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Miasto*</label>
                                                <input id="modalMiasto" required style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Województwo</label>
                                                <input id="modalWoj" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Kraj</label>
                                                <input id="modalKraj" value="Polska" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Tryb*</label>
                                                <select id="modalTryb" required style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                                    <option>Online</option>
                                                    <option>Na miejscu</option>
                                                    <option>Hybrydowo</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Obszar (km)</label>
                                                <input id="modalObszar" type="number" min="0" placeholder="np. 50" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                        </div>
                                    </fieldset>

                                    <fieldset style="grid-column:1 / -1; border:1px solid #00ff00; border-radius:12px; padding:14px;">
                                        <legend style="color:#00ff00; padding:0 8px;">Cennik i dostępność</legend>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap:14px;">
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Cena od</label>
                                                <input id="modalCenaOd" type="number" min="0" step="0.01" placeholder="0.00" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Cena do</label>
                                                <input id="modalCenaDo" type="number" min="0" step="0.01" placeholder="0.00" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Waluta</label>
                                                <select id="modalWaluta" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                                    <option>PLN</option>
                                                    <option>EUR</option>
                                                    <option>USD</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Stawka</label>
                                                <select id="modalStawka" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                                    <option>Godzinowa</option>
                                                    <option>Projekt</option>
                                                    <option>Ryczałt</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">VAT</label>
                                                <select id="modalVAT" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                                    <option>zw</option>
                                                    <option>23%</option>
                                                    <option>8%</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Czas realizacji (dni)</label>
                                                <input id="modalCzasReal" type="number" min="0" placeholder="np. 7" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Ekspres</label>
                                                <select id="modalEkspres" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                                    <option>Nie</option>
                                                    <option>Tak</option>
                                                </select>
                                            </div>
                                        </div>
                                    </fieldset>

                                    <fieldset style="grid-column:1 / -1; border:1px solid #00ff00; border-radius:12px; padding:14px;">
                                        <legend style="color:#00ff00; padding:0 8px;">Dane wykonawcy</legend>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:14px;">
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Wykonawca*</label>
                                                <input id="modalProvider" required style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">NIP</label>
                                                <input id="modalNIP" placeholder="opcjonalnie" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">E-mail / Telefon*</label>
                                                <input id="modalKontakt" required placeholder="email lub telefon" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">WWW</label>
                                                <input id="modalWWW" type="url" placeholder="https://" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">LinkedIn</label>
                                                <input id="modalLI" type="url" placeholder="https://linkedin.com/..." style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Facebook</label>
                                                <input id="modalFB" type="url" placeholder="https://facebook.com/..." style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                        </div>
                                    </fieldset>

                                    <fieldset style="grid-column:1 / -1; border:1px solid #00ff00; border-radius:12px; padding:14px;">
                                        <legend style="color:#00ff00; padding:0 8px;">Portfolio i certyfikaty</legend>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:14px;">
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Portfolio (linki)</label>
                                                <div id="portfolioList">
                                                    <input class="portfolio-item" placeholder="https://..." style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff; margin-bottom:8px;">
                                                </div>
                                                <button type="button" id="addPortfolioBtn" style="background:#00ff00;color:#111;border:none;border-radius:8px;padding:8px 12px;font-weight:bold;cursor:pointer;">+ Dodaj link</button>
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Certyfikaty</label>
                                                <div id="certList">
                                                    <input class="cert-item" placeholder="np. Google Ads, ISO..." style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff; margin-bottom:8px;">
                                                </div>
                                                <button type="button" id="addCertBtn" style="background:#00ff00;color:#111;border:none;border-radius:8px;padding:8px 12px;font-weight:bold;cursor:pointer;">+ Dodaj certyfikat</button>
                                            </div>
                                        </div>
                                    </fieldset>

                                    <fieldset style="grid-column:1 / -1; border:1px solid #00ff00; border-radius:12px; padding:14px;">
                                        <legend style="color:#00ff00; padding:0 8px;">Ustawienia ogłoszenia</legend>
                                        <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:14px; align-items:end;">
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Język obsługi</label>
                                                <input id="modalJezyki" placeholder="np. PL, EN" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Gwarancja (dni)</label>
                                                <input id="modalGwar" type="number" min="0" placeholder="np. 30" style="width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff;">
                                            </div>
                                            <div>
                                                <label style="color:#00ff00; font-weight:bold;">Wyróżnienie PREMIUM (+49,99 zł)</label>
                                                <select id="modalPremium" style="width:100%; padding:10px; border-radius:8px; border:2px solid #FFD700; background:#111; color:#FFD700;">
                                                    <option value="">Nie</option>
                                                    <option value="1">Tak</option>
                                                </select>
                                                <div id="premiumPayNote" style="display:none; color:#FFD700; font-size:0.95rem; margin-top:6px;">Wybrano wyróżnienie PREMIUM: +49,99 zł brutto</div>
                                            </div>
                                        </div>
                                    </fieldset>

                                    <div style="grid-column:1 / -1; display:flex; align-items:center; gap:12px; margin-top:8px;">
                                        <input id="modalReg" type="checkbox" required>
                                        <label for="modalReg">Akceptuję regulamin i politykę prywatności</label>
                                    </div>
                                    <div id="addServiceMsg" style="grid-column:1 / -1; color:#FFD700; font-weight:bold;"></div>
                                                                        <div class="btn-row" style="grid-column:1 / -1; display:flex; gap:12px; justify-content:flex-end; margin-top:8px;">
                                        <button type="button" id="cancelServiceBtn" style="background:#333;color:#fff;border:1px solid #555;border-radius:10px;padding:12px 18px;cursor:pointer;">Anuluj</button>
                                        <button type="submit" style="background:linear-gradient(90deg,#00ff00,#00fff7); color:#111; font-size:1.05rem; font-weight:bold; padding:12px 22px; border:none; border-radius:12px; box-shadow:0 4px 18px #00ff0033; cursor:pointer;">💾 Zapisz usługę</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                                                                        <style>
                                                    /* Responsywne poprawki formularza dodawania usługi i paska wyszukiwania */
                                                                            #addServiceCard, #addServiceCard * { box-sizing: border-box; }
                                                                            #addServiceCard { overflow-x: hidden; }
                                                                            /* Elastyczne kolumny zapobiegające "wypychaniu" prawej krawędzi */
                                                                            #addServiceForm { grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)) !important; }
                                                                            #addServiceForm fieldset > div { grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)) !important; }
                                                                            #addServiceForm input,
                                                                            #addServiceForm select,
                                                                            #addServiceForm textarea { width: 100% !important; max-width: 100% !important; min-width: 0 !important; overflow: hidden; text-overflow: ellipsis; word-break: break-word; }
                                                                            #addServiceForm .btn-row button { min-width: 0; }
                                                    @media (max-width: 1200px) {
                                                        #addServiceCard { max-width: 95vw !important; width: 95vw !important; padding: 22px !important; }
                                                                                #addServiceForm { grid-template-columns: 1fr !important; gap: 14px !important; }
                                                                                #addServiceForm fieldset > div { grid-template-columns: 1fr !important; gap: 12px !important; }
                                                    }
                                                    @media (max-width: 780px) {
                                                        #addServiceCard { max-width: 96vw !important; width: 96vw !important; padding: 16px !important; border-radius: 16px !important; }
                                                        #addServiceForm { grid-template-columns: 1fr !important; gap: 12px !important; }
                                                        #addServiceForm fieldset { padding: 12px !important; }
                                                        #addServiceForm fieldset > div { grid-template-columns: 1fr !important; gap: 10px !important; }
                                                        .btn-row { flex-direction: column !important; align-items: stretch !important; }
                                                        #serviceSearchForm { display: grid !important; grid-template-columns: 1fr !important; justify-items: stretch !important; }
                                                        #serviceSearchForm input { width: 100% !important; max-width: none !important; margin: 6px 0 !important; }
                                                        #serviceSearchForm button { width: 100% !important; }
                                                    }
                                                </style>
        </div>
        <div class="page-title">
            <h1>🛠️ Usługi</h1>
            <p>Znajdź lub dodaj usługę z naszej bazy</p>
        </div>
        <section class="stats-section">
            <div class="stat-card">
                <div class="stat-number" id="totalServices">-</div>
                <div class="stat-label">Aktywnych usług</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="newServicesToday">-</div>
                <div class="stat-label">Nowych dzisiaj</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="providersCount">-</div>
                <div class="stat-label">Wykonawców</div>
            </div>
        </section>
        <section class="services-section">
            <div class="section-header">
                <h2 class="section-title">Najnowsze usługi</h2>
                <span class="services-count" id="servicesCount">Ładowanie...</span>
            </div>
            <!-- Pasek wyszukiwania usług -->
            <form id="serviceSearchForm" style="text-align:center; margin-bottom:24px;">
                <input type="text" id="serviceSearchInput" placeholder="🔍 Wyszukaj usługę, wykonawcę, kategorię..." style="width:40%; max-width:300px; padding:12px; border-radius:10px; border:2px solid #00ff00; font-size:1.1rem; background:#111; color:#fff;">
                <input type="text" id="serviceLocationInput" placeholder="📍 Lokalizacja (np. Warszawa)" style="width:25%; max-width:160px; padding:12px; border-radius:10px; border:2px solid #00ff00; font-size:1.1rem; background:#111; color:#fff; margin-left:10px;">
                <button type="submit" style="background:#00ff00; color:#111; font-weight:bold; padding:12px 28px; border:none; border-radius:10px; font-size:1.1rem; margin-left:10px; cursor:pointer;">Szukaj</button>
            </form>
            <div id="serviceCardsContainer">
                <div class="loading">
                    <div class="spinner"></div>
                    Ładowanie usług...
                </div>
            </div>
            <!-- Panel informacyjny paginacji -->
            <div id="pagination-info" style="display: none; text-align: center; margin: 20px 0; padding: 15px; background: rgba(0,255,0,0.1); border: 1px solid #00ff00; border-radius: 10px; color: #00ff00; font-weight: bold;">
                <div style="font-size: 1.1rem; margin-bottom: 5px;">
                  📊 <span id="pagination-current-range"></span>
                </div>
                <div style="font-size: 0.9rem; color: #FFD700;">
                  💡 Wskazówka: Użyj Ctrl + strzałki do szybkiej nawigacji
                </div>
            </div>
            <div class="pagination-bar" id="pagination-bar" style="display: none;"></div>
        </section>
    </main>
    <!-- Modal formularza kontaktowego -->
    <div id="contactModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.85); z-index:99999; justify-content:center; align-items:center;">
      <div style="background:#222; padding:36px 28px; border-radius:18px; max-width:420px; width:92%; box-shadow:0 8px 40px #FFD70055; color:#fff; position:relative; max-height:90vh; overflow-y:auto; display:flex; flex-direction:column;">
        <button id="closeContactModalBtn" type="button" style="position:absolute; top:14px; right:14px; background:none; border:none; color:#FFD700; font-size:2rem; cursor:pointer;">&times;</button>
        <h2 style="color:#FFD700; margin-bottom:12px; text-align:center;">Formularz kontaktowy</h2>
        <div id="contactServiceInfo" style="margin-bottom:12px; text-align:center;"></div>
        <form id="contactForm">
          <input type="hidden" id="contactEmail" name="email">
          <div style="margin-bottom:14px;">
            <label for="contactMessage" style="color:#FFD700; font-weight:bold;">Wiadomość*</label>
            <textarea id="contactMessage" name="message" required rows="4" style="width:100%; padding:10px; border-radius:8px; border:2px solid #FFD700; background:#111; color:#fff;"></textarea>
          </div>
          <button type="submit" style="width:100%; background:linear-gradient(90deg,#FFD700,#FFB300); color:#111; font-size:1.1rem; font-weight:bold; padding:12px 0; border:none; border-radius:10px; box-shadow:0 4px 14px #FFD70055; cursor:pointer; margin-bottom:8px;">Wyślij</button>
        </form>
        <div id="contactFormMsg" style="margin-top:10px; text-align:center; color:#FFD700; font-weight:bold;"></div>
      </div>
    </div>
    <script>
        // Diagnostyka ładowania tła
        window.addEventListener('DOMContentLoaded', function() {
          var img = new window.Image();
          img.onload = function() {
            // Obrazek się ładuje, nic nie rób
          };
          img.onerror = function() {
            var warn = document.createElement('div');
            warn.style.position = 'fixed';
            warn.style.top = '0';
            warn.style.left = '0';
            warn.style.width = '100vw';
            warn.style.height = '100vh';
            warn.style.background = 'rgba(255,0,0,0.85)';
            warn.style.color = '#fff';
            warn.style.fontSize = '2.2rem';
            warn.style.display = 'flex';
            warn.style.justifyContent = 'center';
            warn.style.alignItems = 'center';
            warn.style.zIndex = '99999';
            warn.innerText = "Nie można załadować obrazu: images/tlo.jpg!\nSprawdź ścieżkę, nazwę pliku i folderu (wielkość liter, rozszerzenie, lokalizację).";
            document.body.appendChild(warn);
          };
          img.src = 'images/tlo.jpg';
        });
        let allServices = [];
        let filteredServices = [];
        // Pagination variables (required for displayServices)
        let currentPage = 1;
        const servicesPerPage = 8;
        // Tymczasowa funkcja, by nie było błędu JS
        // Zaawansowana paginacja (identyczna jak oferty-pracy.html)
        function updatePaginationInfo() {
            const infoPanel = document.getElementById('pagination-info');
            const rangeSpan = document.getElementById('pagination-current-range');
            if (!filteredServices.length) {
                infoPanel.style.display = 'none';
                return;
            }
            const total = filteredServices.length;
            const start = (currentPage - 1) * servicesPerPage + 1;
            const end = Math.min(currentPage * servicesPerPage, total);
            rangeSpan.textContent = `Wyświetlono ${start} - ${end} z ${total} usług`;
            infoPanel.style.display = 'block';
        }

        function renderPaginationBar() {
            const bar = document.getElementById('pagination-bar');
            if (!filteredServices.length) {
                bar.style.display = 'none';
                bar.innerHTML = '';
                return;
            }
            const total = filteredServices.length;
            const totalPages = Math.ceil(total / servicesPerPage);
            if (totalPages <= 1) {
                bar.style.display = 'none';
                bar.innerHTML = '';
                return;
            }
            bar.style.display = 'flex';
            bar.innerHTML = '';

            // Przycisk poprzednia strona
            const prevBtn = document.createElement('button');
            prevBtn.className = 'pagination-btn pagination-navigation-btn';
            prevBtn.innerHTML = '⏮️';
            prevBtn.disabled = currentPage === 1;
            prevBtn.setAttribute('aria-label', 'Poprzednia strona');
            prevBtn.onclick = function() {
                if (currentPage > 1) {
                    currentPage--;
                    displayServices();
                    window.scrollTo({ top: bar.offsetTop - 120, behavior: 'smooth' });
                }
            };
            addRippleEffect(prevBtn);
            bar.appendChild(prevBtn);

            // Szybka nawigacja: pierwsza strona
            if (currentPage > 3) {
                const firstBtn = document.createElement('button');
                firstBtn.className = 'pagination-btn';
                firstBtn.textContent = '1';
                firstBtn.setAttribute('data-page', '1');
                firstBtn.onclick = function() {
                    currentPage = 1;
                    displayServices();
                    window.scrollTo({ top: bar.offsetTop - 120, behavior: 'smooth' });
                };
                addRippleEffect(firstBtn);
                bar.appendChild(firstBtn);
                if (currentPage > 4) {
                    const sep = document.createElement('span');
                    sep.className = 'pagination-separator';
                    sep.textContent = '...';
                    bar.appendChild(sep);
                }
            }

            // Główne numery stron
            for (let i = Math.max(1, currentPage - 2); i <= Math.min(totalPages, currentPage + 2); i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = 'pagination-btn' + (i === currentPage ? ' active' : '');
                pageBtn.textContent = i;
                pageBtn.setAttribute('data-page', i);
                pageBtn.onclick = function() {
                    if (i !== currentPage) {
                        currentPage = i;
                        displayServices();
                        window.scrollTo({ top: bar.offsetTop - 120, behavior: 'smooth' });
                    }
                };
                addRippleEffect(pageBtn);
                bar.appendChild(pageBtn);
            }

            // Szybka nawigacja: ostatnia strona
            if (currentPage < totalPages - 2) {
                if (currentPage < totalPages - 3) {
                    const sep = document.createElement('span');
                    sep.className = 'pagination-separator';
                    sep.textContent = '...';
                    bar.appendChild(sep);
                }
                const lastBtn = document.createElement('button');
                lastBtn.className = 'pagination-btn';
                lastBtn.textContent = totalPages;
                lastBtn.setAttribute('data-page', totalPages);
                lastBtn.onclick = function() {
                    currentPage = totalPages;
                    displayServices();
                    window.scrollTo({ top: bar.offsetTop - 120, behavior: 'smooth' });
                };
                addRippleEffect(lastBtn);
                bar.appendChild(lastBtn);
            }

            // Przycisk następna strona
            const nextBtn = document.createElement('button');
            nextBtn.className = 'pagination-btn pagination-navigation-btn';
            nextBtn.innerHTML = '⏭️';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.setAttribute('aria-label', 'Następna strona');
            nextBtn.onclick = function() {
                if (currentPage < totalPages) {
                    currentPage++;
                    displayServices();
                    window.scrollTo({ top: bar.offsetTop - 120, behavior: 'smooth' });
                }
            };
            addRippleEffect(nextBtn);
            bar.appendChild(nextBtn);

            // Zaawansowana nawigacja
            const advancedNav = document.createElement('div');
            advancedNav.className = 'pagination-advanced-nav';
            advancedNav.style.display = 'flex';
            advancedNav.style.alignItems = 'center';
            advancedNav.style.gap = '12px';

            // Info o pozycji
            const positionInfo = document.createElement('span');
            positionInfo.className = 'pagination-position-info';
            positionInfo.textContent = `Strona ${currentPage} z ${totalPages}`;
            advancedNav.appendChild(positionInfo);

            // Separator
            const separator1 = document.createElement('span');
            separator1.textContent = '|';
            separator1.className = 'pagination-separator';
            advancedNav.appendChild(separator1);

            // Skok do strony
            const jumpContainer = document.createElement('span');
            jumpContainer.style.display = 'flex';
            jumpContainer.style.alignItems = 'center';
            jumpContainer.style.gap = '6px';

            const jumpLabel = document.createElement('span');
            jumpLabel.className = 'pagination-jump-label';
            jumpLabel.textContent = 'Skocz do:';
            jumpContainer.appendChild(jumpLabel);

            const jumpInput = document.createElement('input');
            jumpInput.type = 'number';
            jumpInput.min = 1;
            jumpInput.max = totalPages;
            jumpInput.className = 'pagination-jump-input';
            jumpInput.id = 'pagination-jump-input';
            jumpInput.style.width = '60px';
            jumpInput.placeholder = 'Nr str.';
            jumpInput.title = `Wpisz numer strony (1-${totalPages})\n🔥 Skróty klawiszowe:\n• Enter - przejdź do strony\n• Ctrl + ← - poprzednia strona\n• Ctrl + → - następna strona\n• Ctrl + Home - pierwsza strona\n• Ctrl + End - ostatnia strona`;
            jumpContainer.appendChild(jumpInput);

            const jumpBtn = document.createElement('button');
            jumpBtn.type = 'button';
            jumpBtn.textContent = '🚀 PRZEJDŹ';
            jumpBtn.className = 'pagination-jump-btn';
            jumpBtn.style.fontSize = '0.9rem';
            jumpBtn.style.fontWeight = 'bold';
            jumpBtn.onclick = function() {
                let val = parseInt(jumpInput.value, 10);
                if (isNaN(val) || val < 1) {
                    jumpInput.style.background = 'rgba(255,0,0,0.15)';
                    setTimeout(() => jumpInput.style.background = '', 800);
                    return;
                }
                if (val > totalPages) {
                    jumpInput.style.background = 'rgba(255,0,0,0.15)';
                    setTimeout(() => jumpInput.style.background = '', 800);
                    return;
                }
                if (val !== currentPage) {
                    currentPage = val;
                    displayServices();
                    window.scrollTo({ top: bar.offsetTop - 120, behavior: 'smooth' });
                }
            };
            jumpContainer.appendChild(jumpBtn);
            advancedNav.appendChild(jumpContainer);

            // Skróty klawiszowe
            jumpInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') jumpBtn.click();
                if (e.ctrlKey) {
                    if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        if (currentPage > 1) {
                            currentPage--;
                            displayServices();
                        }
                    } else if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        if (currentPage < totalPages) {
                            currentPage++;
                            displayServices();
                        }
                    } else if (e.key === 'Home') {
                        e.preventDefault();
                        if (currentPage !== 1) {
                            currentPage = 1;
                            displayServices();
                        }
                    } else if (e.key === 'End') {
                        e.preventDefault();
                        if (currentPage !== totalPages) {
                            currentPage = totalPages;
                            displayServices();
                        }
                    }
                }
            });

            bar.appendChild(advancedNav);
        }

        // Efekt ripple na przyciskach paginacji
        function addRippleEffect(btn) {
            btn.addEventListener('click', function(e) {
                const ripple = document.createElement('span');
                ripple.className = 'ripple';
                ripple.style.left = (e.offsetX - 10) + 'px';
                ripple.style.top = (e.offsetY - 10) + 'px';
                ripple.style.width = ripple.style.height = '20px';
                btn.appendChild(ripple);
                setTimeout(() => {
                    ripple.remove();
                }, 500);
            });
        }
        function closeAddServiceModal() {
          document.getElementById('addServiceModal').style.display = 'none';
          document.getElementById('addServiceMsg').textContent = '';
          document.getElementById('addServiceForm').reset();
        }

        document.addEventListener('DOMContentLoaded', function() {
                    // Otwórz modal po kliknięciu w przycisk "Dodaj usługę"
                    const openBtn = document.getElementById('addServiceBtn');
                    if (openBtn) {
                        openBtn.addEventListener('click', () => {
                            document.getElementById('addServiceModal').style.display = 'flex';
                        });
                    }
          // Obsługa wyszukiwarki usług
          const searchForm = document.getElementById('serviceSearchForm');
          const searchInput = document.getElementById('serviceSearchInput');
          const locationInput = document.getElementById('serviceLocationInput');
          if (searchForm && searchInput && locationInput) {
            searchForm.onsubmit = function(e) {
              e.preventDefault();
              const query = searchInput.value.trim().toLowerCase();
              const location = locationInput.value.trim().toLowerCase();
              filteredServices = allServices.filter(s => {
                const matchesQuery = !query || (
                  (s['Nazwa'] && s['Nazwa'].toLowerCase().includes(query)) ||
                  (s['Opis'] && s['Opis'].toLowerCase().includes(query)) ||
                  (s['Wykonawca'] && s['Wykonawca'].toLowerCase().includes(query)) ||
                  (s['Kategoria'] && s['Kategoria'].toLowerCase().includes(query))
                );
                const matchesLocation = !location || (s['Lokalizacja'] && s['Lokalizacja'].toLowerCase().includes(location));
                return matchesQuery && matchesLocation;
              });
              currentPage = 1;
              displayServices();
              updateServicesCount();
              updatePaginationInfo();
            };
          }
          // Obsługa zamykania modala
          var closeBtn = document.getElementById('closeAddServiceModalBtn');
          if (closeBtn) {
            closeBtn.addEventListener('click', function(e) {
              e.stopPropagation();
              closeAddServiceModal();
            });
          }
                    const cancelBtn = document.getElementById('cancelServiceBtn');
                    if (cancelBtn) {
                        cancelBtn.addEventListener('click', closeAddServiceModal);
                    }
                    // Dynamiczne pola: podkategorie, portfolio, certyfikaty
                    const katSelect = document.getElementById('modalKategoria');
                    const subSelect = document.getElementById('modalPodkategoria');
                    const subMap = {
                        'IT': ['Strony WWW', 'Sklepy', 'SEO', 'DevOps', 'Aplikacje'],
                        'Budownictwo': ['Remonty', 'Wykończenia', 'Elewacje', 'Dachy'],
                        'Marketing': ['Social Media', 'Kampanie Ads', 'Content'],
                        'Księgowość': ['KPiR', 'Pełna', 'Kadry'],
                        'Grafika': ['Logo', 'Branding', 'UI/UX'],
                        'Prawo': ['Firmowe', 'Cywilne', 'Podatkowe'],
                        'Tłumaczenia': ['PL-EN', 'EN-PL', 'Specjalistyczne'],
                        'Sprzątanie': ['Biura', 'Domy', 'Poremontowe']
                    };
                    if (katSelect && subSelect) {
                        katSelect.addEventListener('change', () => {
                            const v = katSelect.value;
                            subSelect.innerHTML = '';
                            (subMap[v] || []).forEach(s => {
                                const o = document.createElement('option');
                                o.textContent = s;
                                subSelect.appendChild(o);
                            });
                        });
                                    // Ustaw wstępne podkategorie dla domyślnej kategorii
                                    if (katSelect.value) {
                                        const evt = new Event('change');
                                        katSelect.dispatchEvent(evt);
                                    }
                    }
                    const portfolioList = document.getElementById('portfolioList');
                    const addPortfolioBtn = document.getElementById('addPortfolioBtn');
                    if (addPortfolioBtn && portfolioList) {
                        addPortfolioBtn.addEventListener('click', () => {
                            const inp = document.createElement('input');
                            inp.className = 'portfolio-item';
                            inp.placeholder = 'https://...';
                            inp.style.cssText = 'width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff; margin-bottom:8px;';
                            portfolioList.appendChild(inp);
                        });
                    }
                    const certList = document.getElementById('certList');
                    const addCertBtn = document.getElementById('addCertBtn');
                    if (addCertBtn && certList) {
                        addCertBtn.addEventListener('click', () => {
                            const inp = document.createElement('input');
                            inp.className = 'cert-item';
                            inp.placeholder = 'np. Google Ads, ISO...';
                            inp.style.cssText = 'width:100%; padding:10px; border-radius:8px; border:2px solid #00ff00; background:#111; color:#fff; margin-bottom:8px;';
                            certList.appendChild(inp);
                        });
                    }
          // Obsługa formularza dodawania usługi
          const form = document.getElementById('addServiceForm');
          if (form) {
            form.onsubmit = function(e) {
              e.preventDefault();
                            // Pobierz wszystkie pola z rozbudowanego formularza (bezpiecznie)
                            const gv = (id) => {
                                const el = document.getElementById(id);
                                if (!el) return '';
                                if (el.tagName === 'SELECT') return (el.value || '').toString().trim();
                                return (el.value || '').toString().trim();
                            };
                            const nazwa = gv('modalNazwa');
                            const opis = gv('modalOpis');
                            const kategoria = gv('modalKategoria');
                            const podkat = gv('modalPodkategoria');
                            const tagi = gv('modalTagi');
                            const zakres = gv('modalZakres');
                            const miasto = gv('modalMiasto');
                            const woj = gv('modalWoj');
                            const kraj = gv('modalKraj');
                            const tryb = gv('modalTryb');
                            const obszar = gv('modalObszar');
                            const cenaOd = gv('modalCenaOd');
                            const cenaDo = gv('modalCenaDo');
                            const waluta = gv('modalWaluta');
                            const stawka = gv('modalStawka');
                            const vat = gv('modalVAT');
                            const czasReal = gv('modalCzasReal');
                            const ekspres = gv('modalEkspres');
                            const provider = gv('modalProvider');
                            const nip = gv('modalNIP');
                            const kontakt = gv('modalKontakt');
                            const www = gv('modalWWW');
                            const li = gv('modalLI');
                            const fb = gv('modalFB');
                            const jezyki = gv('modalJezyki');
                            const gwar = gv('modalGwar');
                                            const premiumEl = document.getElementById('modalPremium');
                                            let premiumVal = false;
                                            if (premiumEl) {
                                                if (premiumEl.type === 'checkbox') premiumVal = premiumEl.checked;
                                                else premiumVal = ['tak','true','1','on','yes'].includes((premiumEl.value || '').toString().trim().toLowerCase());
                                            }
                              const portfolio = Array.from(document.querySelectorAll('#portfolioList .portfolio-item')).map(i => i.value.trim()).filter(Boolean);
                            const certs = Array.from(document.querySelectorAll('#certList .cert-item')).map(i => i.value.trim()).filter(Boolean);
              let msg = '✅ Usługa została dodana!';
              document.getElementById('addServiceMsg').textContent = msg;
                            allServices.unshift({
                                'Nazwa': nazwa,
                                'Opis': opis,
                                'Zakres': zakres,
                                'Kategoria': kategoria,
                                'Podkategoria': podkat,
                                'Tagi': tagi,
                                'Lokalizacja': [miasto, woj, kraj].filter(Boolean).join(', '),
                                'Tryb': tryb,
                                'Obszar': obszar,
                                'CenaOd': cenaOd,
                                'CenaDo': cenaDo,
                                'Waluta': waluta,
                                'Stawka': stawka,
                                'VAT': vat,
                                'CzasRealizacji': czasReal,
                                'Ekspres': ekspres,
                                'Wykonawca': provider,
                                'NIP': nip,
                                'Kontakt': kontakt,
                                'WWW': www,
                                'LinkedIn': li,
                                'Facebook': fb,
                                'Języki': jezyki,
                                'Gwarancja': gwar,
                                                'Premium': premiumVal,
                                                'PremiumFeePLN': premiumVal ? 49.99 : 0,
                                'Portfolio': portfolio,
                                'Certyfikaty': certs
                            });
              filteredServices = [...allServices];
              updateStats();
              displayServices();
              setTimeout(closeAddServiceModal, 1800);
            };
          }

                                    // ESC zamyka modal dodawania usługi
                                    document.addEventListener('keydown', (ev) => {
                                        if (ev.key === 'Escape') {
                                            const modal = document.getElementById('addServiceModal');
                                            if (modal && modal.style.display !== 'none') closeAddServiceModal();
                                        }
                                    });

                                                // Pokaż notkę o dopłacie przy wyborze premium
                                                const premiumSelect = document.getElementById('modalPremium');
                                                const premiumNote = document.getElementById('premiumPayNote');
                                                if (premiumSelect && premiumNote) {
                                                    const toggleNote = () => {
                                                        const v = (premiumSelect.value || '').toString();
                                                        premiumNote.style.display = v === '1' ? 'block' : 'none';
                                                    };
                                                    premiumSelect.addEventListener('change', toggleNote);
                                                    toggleNote();
                                                }
          // Automatyczne ładowanie usług po załadowaniu strony
          loadServices();
        });
        function loadServices() {
            // Generowanie 101 przykładowych usług w JS (zamiast CSV)
            const kategorie = ['IT', 'Budownictwo', 'Marketing', 'Księgowość', 'Grafika', 'Prawo', 'Tłumaczenia', 'Sprzątanie'];
            const miasta = ['Warszawa', 'Kraków', 'Gdańsk', 'Poznań', 'Wrocław', 'Łódź', 'Katowice', 'Toruń', 'Online'];
            const firmy = ['Uniwersal Bud', 'TechFlow', 'GreenSoft', 'ProMark', 'FinServ', 'ArtVision', 'Lexis', 'CleanPro'];
            const wwws = ['https://example.com', 'https://firma.pl', 'https://twojabiznes.pl', ''];

            const generated = [];
            for (let i = 1; i <= 101; i++) {
                const kat = kategorie[i % kategorie.length];
                const miasto = miasta[i % miasta.length];
                const firma = firmy[i % firmy.length];
                const isPremium = (i % 10 === 0) ? '1' : ''; // co 10. ogłoszenie premium
                const www = wwws[i % wwws.length];
                generated.push({
                    'Nazwa': `${kat} - Usługa #${i}`,
                    'Opis': `Opis przykładowej usługi #${i} w kategorii ${kat}. Profesjonalna realizacja, szybkie terminy i konkurencyjna cena.`,
                    'Kategoria': kat,
                    'Lokalizacja': miasto,
                    'Wykonawca': firma,
                    'Kontakt': `kontakt${i}@${firma.replace(/\s+/g,'').toLowerCase()}.pl`,
                    'Premium': isPremium,
                    'WWW': www
                });
            }
            allServices = generated;
            filteredServices = [...allServices];
            updateStats();
            displayServices();
        }

        function updateStats() {
            document.getElementById('totalServices').textContent = allServices.length.toLocaleString();
            document.getElementById('newServicesToday').textContent = Math.floor(allServices.length * 0.1);
            const providers = new Set(allServices.map(s => (s['Wykonawca'] || s['Kontakt'] || '').trim()));
            document.getElementById('providersCount').textContent = providers.size;
            updateServicesCount();
        }

        // Aktualizuje licznik wyświetlanych usług (dynamicznie po wyszukiwaniu)
        function updateServicesCount() {
            const countSpan = document.getElementById('servicesCount');
            if (!countSpan) return;
            if (filteredServices.length === allServices.length) {
                countSpan.textContent = `${filteredServices.length} usług`;
            } else if (filteredServices.length === 0) {
                countSpan.textContent = `0 usług`;
            } else {
                countSpan.textContent = `${filteredServices.length} z ${allServices.length} usług`;
            }
        }

        function displayServices() {
            const container = document.getElementById('serviceCardsContainer');
            const start = (currentPage - 1) * servicesPerPage;
            const end = start + servicesPerPage;
            const servicesToShow = filteredServices.slice(start, end);
            // Komunikat gdy nie ma żadnych usług w ogóle (np. błąd ładowania CSV)
            if (allServices.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: #FFD700; padding: 40px;"><h3>⚠️ Brak danych usług</h3><p>Nie wczytano żadnych usług z pliku <b>uslugi.csv</b>.<br>Sprawdź czy plik istnieje, ma poprawne nagłówki i nie jest pusty.</p></div>`;
                updatePaginationInfo();
                renderPaginationBar();
                return;
            }
            // Komunikat gdy nie znaleziono wyników wyszukiwania
            if (servicesToShow.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: #ff2222; padding: 40px;"><h3>🔍 Brak wyników wyszukiwania</h3><p>Nie znaleziono usług spełniających podane kryteria.<br>Spróbuj zmienić frazę lub lokalizację.</p></div>`;
                updatePaginationInfo();
                renderPaginationBar();
                return;
            }
            let servicesHTML = '';
            servicesToShow.forEach((service, idx) => {
                const wykonawca = service['Wykonawca'] || service['Kontakt'] || '';
                const lokalizacjaPremium = service['Lokalizacja'] ? `<span class=\"job-company premium-location\">${service['Lokalizacja']}</span>` : '';
                const lokalizacja = service['Lokalizacja'] ? `<span class="job-company">${service['Lokalizacja']}</span>` : '';
                const email = service['Kontakt'] ? encodeURIComponent(service['Kontakt']) : '';
                const btnId = `contact-btn-${start + idx}`;
                const isPremium = service['Premium'] && (service['Premium'] === '1' || service['Premium'].toLowerCase() === 'tak');
                if (isPremium) {
                    servicesHTML += `
                    <div class=\"job-card premium-card\">\n                        <div class=\"job-header\">\n                            <div>\n                                <div class=\"job-title\" style=\"color:#fff; font-size:2rem; text-shadow:0 2px 24px #FFD700, 0 0 12px #fff; z-index:2; position:relative;\">${service['Nazwa']}</div>\n                            </div>\n                            ${lokalizacjaPremium}\n                        </div>\n                        <div class=\"premium-overlay\"></div>\n                        <div class=\"premium-label\">PREMIUM</div>\n                        <div class=\"job-description\" style=\"color:#fff; font-size:1.15rem; text-shadow:0 0 16px #FFD700, 0 0 8px #fff; z-index:2; position:relative;\">${service['Opis']}</div>\n                        <div class=\"job-actions\" style=\"z-index:2; position:relative;\">\n                            <button class=\"btn-contact\" id=\"${btnId}\" data-email=\"${email}\" data-nazwa=\"${encodeURIComponent(service['Nazwa'] || '')}\" data-wykonawca=\"${encodeURIComponent(wykonawca)}\">📧 Kontakt</button>\n                            ${service['WWW'] ? `<button class='btn-details' style=\\"border-color:#FFD700;color:#FFD700;\\" onclick=\\"window.open('${service['WWW']}', '_blank')\\">🌐 Strona</button>` : ''}\n                        </div>\n                    </div>\n                    `;
                } else {
                    servicesHTML += `
                    <div class=\"job-card\">\n                        <div class=\"job-header\">\n                            <div>\n                                <div class=\"job-title\">${service['Nazwa']}</div>\n                            </div>\n                            ${lokalizacja}\n                        </div>\n                        <div class=\"job-description\">${service['Opis']}</div>\n                        <div class=\"job-actions\">\n                            <button class=\"btn-contact\" id=\"${btnId}\" data-email=\"${email}\" data-nazwa=\"${encodeURIComponent(service['Nazwa'] || '')}\" data-wykonawca=\"${encodeURIComponent(wykonawca)}\">📧 Kontakt</button>\n                            ${service['WWW'] ? `<button class='btn-details' onclick=\\"window.open('${service['WWW']}', '_blank')\\">🌐 Strona</button>` : ''}\n                        </div>\n                    </div>\n                    `;
                }
            });
            container.innerHTML = `<div class="service-cards-grid job-offers-grid">${servicesHTML}</div>`;
            // Dodaj obsługę kliknięcia do wszystkich przycisków Kontakt
            servicesToShow.forEach((service, idx) => {
                const btnId = `contact-btn-${start + idx}`;
                const btn = document.getElementById(btnId);
                if (btn) {
                    btn.onclick = function(e) {
                        e.preventDefault();
                        // Pobierz dane do modala
                        const email = btn.getAttribute('data-email');
                        const nazwa = decodeURIComponent(btn.getAttribute('data-nazwa') || '');
                        const wykonawca = decodeURIComponent(btn.getAttribute('data-wykonawca') || '');
                        document.getElementById('contactEmail').value = email;
                        document.getElementById('contactServiceInfo').innerHTML = `<b style='color:#FFD700;'>${nazwa}</b><br><span style='color:#fff;'>${wykonawca}</span>`;
                        document.getElementById('contactMessage').value = '';
                        document.getElementById('contactFormMsg').textContent = '';
                        document.getElementById('contactModal').style.display = 'flex';
                    };
                }
            });
            updatePaginationInfo();
            renderPaginationBar();
            updateServicesCount();
        }


        </script>

<script>
    // Obsługa przycisku Wstecz (z fallbackiem do strony głównej)
    document.addEventListener('DOMContentLoaded', function(){
        var btn = document.getElementById('backBtn');
        if (btn) {
            btn.addEventListener('click', function(){
                if (history.length > 1) { history.back(); }
                else { location.href = 'index.html'; }
            });
        }
    });
</script>
</body>
</html>
